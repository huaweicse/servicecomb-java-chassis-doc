<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Local development and testing - ServiceComb Java Chassis Developers Guide</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Local development and testing";
    var mkdocs_page_input_path = "general-development/local-develop-test.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="icon icon-home"> ServiceComb Java Chassis Developers Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../start/terminology.html">Glossary</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../start/architecture.html">Architecture</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../start/development-environment.html">Development environment</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../start/first-sample.html">Develop the first microservice</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Development Service Provider</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/definition/service-definition.html">Service definition</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/define-contract.html">Service contract definition</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/code-first.html">Implicit API definition</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/swagger-annotation.html">Use Swagger annotations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/springmvc.html">Develop with SpringMVC</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/jaxrs.html">Develop with JAX-RS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/transparent-rpc.html">Develop with Transparent RPC</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/interface-constraints.html">Interface definition and data type</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/listen-address-and-publish-address.html">Service listening address and publishing address</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/thread-pool.html">Thread pool</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Service Configuration</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../build-provider/configuration/ratelimite-strategy.html">Rate Limiting Policy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../build-provider/configuration/downgrade-strategy.html">Fallback Policy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../build-provider/configuration/parameter-validator.html">Parameter Validator</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/bootup.html">Boot-up Process</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/access-log-configuration.html">Access Log Configuration</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Writing Service Consumer</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../build-consumer/common-configuration.html">Consumer common configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-consumer/using-resttemplate.html">Using Rest Template</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-consumer/using-AsyncRestTemplate.html">Using AsyncRestTemplate</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-consumer/develop-consumer-using-rpc.html">Using with RPC</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-consumer/with-contract.html">Contract</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Invoke control</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../build-consumer/circuit-breaker.html">Circuit Breaker</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../build-consumer/flow-control.html">Flow Control</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../build-consumer/fault-injection.html">Fault Injection</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-consumer/3rd-party-service-invoke.html">Invoke 3rd-party REST services</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Transports</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../transports/rest-over-servlet.html">REST over Servlet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../transports/rest-over-vertx.html">REST over Vertx</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../transports/highway-rpc.html">Highway</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../transports/http2.html">HTTP2</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">General Development</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="visit-sc.html">Access Service Center</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="microservice-invocation-chain.html">Microservice invocation chain</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="customized-tracing.html">Customized-Tracing</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="local-develop-test.html">Local development and testing</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#concept-description">Concept Description</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#local-debugging-by-setting-up-environmental-information">Local debugging by setting up environmental information</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#starting-local-servicecenter">Starting Local ServiceCenter</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mock-mechanism-start-service-center">Mock mechanism start service center</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cross-process-call">Cross-process call</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#local-debugging-by-setting-environment-information">Local debugging by setting environment information</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="http-filter.html">Http Filter</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="file-upload.html">File Uploading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="file-download.html">File Downloading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="reactive.html">Reactive Programing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="dnsconfig.html">DNS Custom Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="dai-li-she-zhi.html">Proxy Settings</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="report-framework-version.html">Report framework version</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="cross-app-invocation.html">Cross-application invocation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="secret-field.html">Customized serialization and deserialization</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="context.html">Using Context to pass control messages</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="produceprocess.html">Return value serialization extension</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="CORS.html">CORS mechanism</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="AlarmEvent.html">Get fuse and instance isolation alarm event information</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="shutdown.html">Shutdown gracefully</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="error-handling.html">Handling exceptions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="multienvironment.html">Multi-environment isolation between microservice instances</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="thread-model.html">Thread Model</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Configuration</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../config/general-config.html">General config</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../config/inject-config.html">Configuration injection</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Service Capability Open</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../edge/open-service.html">Intruductions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../edge/by-servicecomb-sdk.html">Using Edge Service</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../edge/nginx.html">Using confd and Nginx as edge services</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../edge/zuul.html">Use zuul as edge services</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Service Packing and Running</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../packaging/standalone.html">Standalone mode</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../packaging/web-container.html">WEB container mode</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Micro Service Security</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../security/tls.html">Using TLS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../security/rsa.html">Using RSA certification</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Using java chassis in Spring Boot</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/using-java-chassis-in-spring-boot.html">Intruductions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/components-for-spring-boot.html">spring boot starter for java-chassis</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/java-application.html">JAVA application development</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/web-application.html">Web development method development</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/diff-between-java-web.html">The difference between JAVA application method and Web development method</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/diff-spring-mvc.html">The difference in Spring MVC mode</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Handlers reference</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../references-handlers/intruduction.html">Intruductions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../references-handlers/loadbalance.html">Load Balancing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../references-handlers/publickey.html">Public key authentication</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">FAQ</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../question-and-answer/question_answer.html">Q & A</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../question-and-answer/faq.html">FAQ</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../question-and-answer/interface-compatibility.html">Micro Service Interface Compatibility FAQ</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ServiceComb Java Chassis Developers Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      
        
          <li>General Development &raquo;</li>
        
      
    
    <li>Local development and testing</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="local-development-and-test">Local Development and Test</h1>
<h2 id="concept-description">Concept Description</h2>
<p>This section describes how developers can locally develop and commission consumer and provider applications. Both service providers and consumers need to connect to the remote service center. Two methods of building Local  ServiceCenter for local microservice commissioning are as follows:</p>
<ul>
<li>
<p>Starting <a href="#starting-local-servicecenter">Local Service Center</a>.</p>
</li>
<li>
<p>Starting Local Service Center <a href="#mock-mechanism-start-service-center">Mock mechanism</a>.</p>
</li>
</ul>
<h3 id="local-debugging-by-setting-up-environmental-information">Local debugging by setting up environmental information</h3>
<p>The Service Center is an important component in the microservice architecture, this is used in managing and handle: registering and discovering, for service metadata and service instance metadata. The logic relationship between the service center and microservice provider/consumer is as follows:<img alt="" src="../assets/images/local_develop_test_en.png" /></p>
<h2 id="starting-local-servicecenter">Starting Local ServiceCenter</h2>
<ul>
<li>
<p><strong>Step 1</strong> Starting local service center</p>
</li>
<li>
<p>run in executable files  </p>
</li>
</ul>
<ul class="nav nav-tabs">
     <li data-toggle="tab" class="active"><a data-toggle="tab" href="#windows">Windows</a></li>
     <li data-toggle="tab"><a data-toggle="tab" href="#linux">Linux</a></li>
   </ul>

<div class="tab-content">
     <div id="windows" class="tab-pane active" markdown="1">
    (1) Download the [Service Registry Executable Compressor] (http://apache.org/dyn/closer.cgi/incubator/servicecomb/incubator-servicecomb-service-center/1.0.0-m1/apache-servicecomb- Incubating-service-center-1.0.0-m1-windows-amd64.tar.gz)  
    (2) Extract to the current folder  
    (3) Go to the unzipped directory and double-click to run the **start-service-center.bat** file.  

      </div>
      <div id="linux" class="tab-pane fade" markdown="1">
    1) Download the Service Registry executable file archive and extract it  
   ```bash
   wget http://apache.org/dyn/closer.cgi/incubator/servicecomb/incubator-servicecomb-service-center/1.0.0-m1/apache-servicecomb-incubating-service-center-1.0.0-m1-linux-amd64.tar.gz
   tar xvf apache-servicecomb-incubating-service-center-1.0.0-m1-linux-amd64.tar.gz
  ```  
   2) Run the service registry  
   ```bash
   Bash apache-servicecomb-incubating-service-center-1.0.0-m1-linux-amd64/start-service-center.sh
   ```  
   
    Note: The frontend (frontend) will be bound to the ipv6 address by default in the Linux environment, causing the browser to report an error. The repair method is: first modify the httpaddr in conf/app.conf to the external reachable network card ip, and then modify the app/appList/apiList. .js `ip : 'http://127.0.0.1'` for the corresponding ip, and finally restart ServiceCenter.
  
    </div>
   </div>

<p>Note: Both Windows and Linux versions only support 64-bit systems.  </p>
<ol>
<li>Run as Docker  </li>
</ol>
<p><code>bash
Docker pull servicecomb/service-center
Docker run -d -p 30100:30100 servicecomb/service-center:latest</code></p>
<ul>
<li><strong>Step 2 </strong> After starting the local service center, configure the ServerCenter address and port in the service provider/consumer's microservice.yaml file. Example code:</li>
</ul>
<p><code>yaml
Servicecomb:
  Service:
    Registry:
      Address:
        #Service Center address and port
        Http://127.0.0.1:30100</code></p>
<ul>
<li><strong>Step 3 </strong>Development service provider/consumer, launch microservices for local testing.</li>
</ul>
<p><strong>----End</strong></p>
<h2 id="mock-mechanism-start-service-center">Mock mechanism start service center</h2>
<p>Simulate a service center that can only be used by this process in the process memory, which is generally used in the test scenario.
* ### In-process call
Just declare it before starting the ServiceComb engine to enable it:</p>
<pre><code class="language-java">System.setProperty(&quot;local.registry.file&quot;, &quot;notExistJustForceLocal&quot;);
</code></pre>
<ul>
<li>
<h3 id="cross-process-call">Cross-process call</h3>
<p>If the deployment is simple and the deployment information is static, you can use this mock mechanism even if you have a cross-process call.
The producer end is still declared like "in-process call"
However, because the Mock does not work across processes, the Mock on the consumer side needs to provide a local configuration file that describes the details of the call target, including the name, version, address, schema id, etc.
Similarly, because the Mock cannot cross processes, the consumer cannot dynamically obtain the contract information of the producer. Therefore, the contract file needs to be provided locally.
(This scenario, using the Mock Service Center, is much more costly than using a standalone service center, not recommended)</p>
</li>
<li>
<p><strong>Step 1</strong> Create a new local service center definition file, assuming the name is registry.yaml, the content example is as follows:  </p>
</li>
<li>
<p><strong>Step 1</strong> Create a new local service center definition file, assuming the name is registry.yaml, the content example is as follows:</p>
</li>
</ul>
<p><code>yaml
localserv:
  - id: "100"
    version: "0.0.1"
    appid: localservreg
    schemaIds:
      - hello
    instances:
      - endpoints:
        - rest://localhost:8080
        - highway://localhost:7070</code>
* <strong>Step 2</strong>consumer local deployment contract file</p>
<p>Reference: [Define Service Contract] (https://docs.servicecomb.io/java-chassis/zh_CN/build-provider/define-contract.html)
* <strong>Step 3</strong> In the consumer main function, declare the ServiceComb engine before starting:</p>
<p><code>java
　　System.setProperty("local.registry.file", "/path/registry.yaml");</code></p>
<p>The second parameter of setProperty fills in the absolute path of the registry.yaml system on the disk, pay attention to distinguish the corresponding path separator in different systems.</p>
<h2 id="local-debugging-by-setting-environment-information">Local debugging by setting environment information</h2>
<p>The java chassis is strictly dependent on the contract when designing, so usually the version of the microservice has to change when the contract updated. However, if the development mode is still in progress, it is normal to modify the interface. <br />
If you need to change the version every time, it is very unfriendly to the user, so an environment setting is added for this case. If the microservice is configured as a development environment, the interface is modified (the schema has changed), and the restart can be registered to the service center without modifying the version number.<br />
However, if  consumer client has already called the service before the restart, the consumer client needs to be restarted to get the latest schema. For example, A -&gt; B, B interface has been modified and restarted, then A is still using B last schema at this time, the call may be wrong, so as to avoid unknown exceptions, A also needs to restart. There are three ways to set it up, Recommended method 1  </p>
<ul>
<li>
<p>Method 1: Set by the JVM startup parameter <br />
<strong>-Dservice_description.environment=development</strong></p>
</li>
<li>
<p>Method 2: Specify by microservice.yaml configuration file</p>
</li>
</ul>
<pre><code class="language-yaml">service_description:
  environment: development
</code></pre>
<ul>
<li>Method 3: Specify by environment variable (only for Windows system), such as the following settings under Eclipse
<img alt="" src="../assets/env.PNG" /></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="http-filter.html" class="btn btn-neutral float-right" title="Http Filter">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="customized-tracing.html" class="btn btn-neutral" title="Customized-Tracing"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="customized-tracing.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="http-filter.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
