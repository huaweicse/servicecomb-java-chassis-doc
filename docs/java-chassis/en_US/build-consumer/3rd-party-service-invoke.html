<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Invoke 3rd-party REST services - ServiceComb Java Chassis Developers Guide</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Invoke 3rd-party REST services";
    var mkdocs_page_input_path = "build-consumer/3rd-party-service-invoke.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="icon icon-home"> ServiceComb Java Chassis Developers Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../start/terminology.html">Glossary</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../start/architecture.html">Architecture</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../start/development-environment.html">Development environment</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../start/first-sample.html">Develop the first microservice</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Development Service Provider</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/definition/service-definition.html">Service definition</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/define-contract.html">Service contract definition</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/code-first.html">Implicit API definition</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/swagger-annotation.html">Use Swagger annotations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/springmvc.html">Develop with SpringMVC</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/jaxrs.html">Develop with JAX-RS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/transparent-rpc.html">Develop with Transparent RPC</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/interface-constraints.html">Interface definition and data type</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/listen-address-and-publish-address.html">Service listening address and publishing address</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/thread-pool.html">Thread pool</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Service Configuration</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../build-provider/configuration/ratelimite-strategy.html">Rate Limiting Policy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../build-provider/configuration/downgrade-strategy.html">Fallback Policy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../build-provider/configuration/parameter-validator.html">Parameter Validator</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/bootup.html">Boot-up Process</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../build-provider/access-log-configuration.html">Access Log Configuration</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Writing Service Consumer</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="common-configuration.html">Consumer common configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="using-resttemplate.html">Using Rest Template</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="using-AsyncRestTemplate.html">Using AsyncRestTemplate</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="develop-consumer-using-rpc.html">Using with RPC</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="with-contract.html">Contract</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Invoke control</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="circuit-breaker.html">Circuit Breaker</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="flow-control.html">Flow Control</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="fault-injection.html">Fault Injection</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="3rd-party-service-invoke.html">Invoke 3rd-party REST services</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#concept-description">Concept Description</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sample-code">Sample Code</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Transports</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../transports/rest-over-servlet.html">REST over Servlet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../transports/rest-over-vertx.html">REST over Vertx</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../transports/highway-rpc.html">Highway</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../transports/http2.html">HTTP2</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">General Development</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/visit-sc.html">Access Service Center</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/metrics.html">Metrics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/microservice-invocation-chain.html">Microservice invocation chain</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/customized-tracing.html">Customized-Tracing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/local-develop-test.html">Local development and testing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/http-filter.html">Http Filter</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/file-upload.html">File Uploading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/file-download.html">File Downloading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/reactive.html">Reactive Programing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/dnsconfig.html">DNS Custom Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/dai-li-she-zhi.html">Proxy Settings</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/report-framework-version.html">Report framework version</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/cross-app-invocation.html">Cross-application invocation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/secret-field.html">Customized serialization and deserialization</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/context.html">Using Context to pass control messages</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/produceprocess.html">Return value serialization extension</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/CORS.html">CORS mechanism</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/AlarmEvent.html">Get fuse and instance isolation alarm event information</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/shutdown.html">Shutdown gracefully</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/error-handling.html">Handling exceptions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/multienvironment.html">Multi-environment isolation between microservice instances</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-development/thread-model.html">Thread Model</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Configuration</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../config/general-config.html">General config</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../config/inject-config.html">Configuration injection</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Service Capability Open</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../edge/open-service.html">Intruductions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../edge/by-servicecomb-sdk.html">Using Edge Service</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../edge/nginx.html">Using confd and Nginx as edge services</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../edge/zuul.html">Use zuul as edge services</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Service Packing and Running</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../packaging/standalone.html">Standalone mode</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../packaging/web-container.html">WEB container mode</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Micro Service Security</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../security/tls.html">Using TLS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../security/rsa.html">Using RSA certification</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Using java chassis in Spring Boot</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/using-java-chassis-in-spring-boot.html">Intruductions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/components-for-spring-boot.html">spring boot starter for java-chassis</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/java-application.html">JAVA application development</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/web-application.html">Web development method development</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/diff-between-java-web.html">The difference between JAVA application method and Web development method</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-java-chassis-in-spring-boot/diff-spring-mvc.html">The difference in Spring MVC mode</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Handlers reference</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../references-handlers/intruduction.html">Intruductions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../references-handlers/loadbalance.html">Load Balancing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../references-handlers/publickey.html">Public key authentication</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">FAQ</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../question-and-answer/question_answer.html">Q & A</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../question-and-answer/faq.html">FAQ</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../question-and-answer/interface-compatibility.html">Micro Service Interface Compatibility FAQ</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ServiceComb Java Chassis Developers Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      
        
          <li>Writing Service Consumer &raquo;</li>
        
      
    
    <li>Invoke 3rd-party REST services</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="invoking-3rd-party-rest-service">Invoking 3rd party REST service</h1>
<h2 id="concept-description">Concept Description</h2>
<p>ServiceComb allows users to register the information of 3rd party REST service, including endpoint and swagger, so that users can invoke 3rd party services like invoking ServiceComb provider services.
Using this feature, all the requests sent to 3rd party service will be processed by consumer handler chain and HttpClientFilters, which means this feature allows service governance function on invoking 3rd party service, and other ServiceComb custom extension mechanism is also supported.</p>
<h2 id="sample-code">Sample Code</h2>
<ol>
<li>Assume that there is a REST 3rd party service, whose listen port is 8080, and rest interface contract is like below:
  ```yaml</li>
</ol>
<hr />
<p>swagger: "2.0"
  info:
    version: "0.0.1"
    title: "3rd party REST service for example"
  basePath: "/rest"
  consumes:
  - "application/json"
  produces:
  - "text/plain"
  paths:
    /{pathVar}:
      get:
        operationId: "testPathVar"
        parameters:
        - name: "pathVar"
          in: "path"
          required: true
          type: "string"
        responses:
          200:
            description: "response of 200, return \"Received, OK. [${pathVar}]\""
            schema:
              type: "string"
  ```</p>
<ol>
<li>
<p>To invoke this service, a java interface class should be written according to the rest contract and annotated by rest annotations.
  The way to write java interface class is similar to writing SpringMVC or JAX-RS style
  ServiceComb provider service. Interface code is like below:
  <code>java
  @Path("/rest")
  @Api(produces = MediaType.TEXT_PLAIN)
  public interface VertxServerIntf {
    @Path("/{pathVar}")
    @GET
    String testPathVar(@PathParam("pathVar") String pathVar);
  }</code></p>
</li>
<li>
<p>Register the information of 3rd party rest service on consumer side:
  <code>java
  String endpoint = "rest://127.0.0.1:8080";
  RegistryUtils.getServiceRegistry().registerMicroserviceMappingByEndpoints(
      // 3rd party rest service name, you can specify the name on your need as long as you obey the microservice naming rule
      "thirdPartyService",
      // service version
      "0.0.1",
      // list of endpoints
      Collections.singletonList(endpoint),
      // java interface class to generate swagger schema
      ThirdPartyRestServiceInterface.class
  );</code></p>
</li>
<li>
<p>Invoke 3rd party rest service in the way similar to invoking ServiceComb provider service.
  Here is a RPC style invoking example:
  ```java
  // declare rpc reference to 3rd party rest service, schemaId is the same as microservice name
  @RpcReference(microserviceName = "thirdPartyService", schemaId = "thirdPartyService")
  ThirdPartyRestServiceInterface thirdPartyRestService;</p>
</li>
</ol>
<p>@RequestMapping(path = "/{pathVar}", method = RequestMethod.GET)
  public String testInvoke(@PathVariable(name = "pathVar") String pathVar) {
    LOGGER.info("testInvoke() is called, pathVar = [{}]", pathVar);
    // invoke 3rd party rest service
    String response = thirdPartyRestService.testPathVar(pathVar);
    LOGGER.info("testInvoke() response = [{}]", response);
    return response;
  }
  ```</p>
<ol>
<li>Service governance on invoking 3rd party REST service</li>
</ol>
<p>The service governance configuration on invoking 3rd party REST service is similar to the scenario that ServiceComb consumer invokes ServiceComb provider. Take the rate limiting policy for example, the configuration of consumer side microservice.yaml is like below:
  <code>yaml
    servicecomb:
      flowcontrol:
        Consumer:
          qps:
            enabled: true
            limit:
              thirdPartyService: 1</code>
  As the config above, the rate to send request to the service named as "thirdPartyService", which is the 3rd party rest service, is limited to 1QPS.
  When request rate is above 1QPS, consumer will get an <code>InvocationException</code> indicating <code>429 Too Many Requests</code> error.</p>
<blockquote>
<p><strong><em>Cautions:</em></strong>
- endpoint is prefixed with <code>rest</code>, instead of <code>http</code>. You can refer the endpoints registered to service center to write it.
- One 3rd party REST service can hold multiple endpoints. Consumer side load balance function is supported.
- Currently the information of a 3rd party service can only be initialized for once. i.e. adding, deleting and modifying is not supported.</p>
</blockquote>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../transports/rest-over-servlet.html" class="btn btn-neutral float-right" title="REST over Servlet">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="fault-injection.html" class="btn btn-neutral" title="Fault Injection"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="fault-injection.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../transports/rest-over-servlet.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
